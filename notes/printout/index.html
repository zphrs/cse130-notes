<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="description" content="Astro description"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/svg+xml" href="/cse130-notes/favicon.svg"><meta name="generator" content="Astro v4.1.2"><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preload" href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&family=Comfortaa:wght@700&family=Fira+Code&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&family=Comfortaa:wght@700&family=Fira+Code&display=swap"></noscript><title>All Notes</title><link rel="stylesheet" href="/cse130-notes/_astro/_slug_.5YG6IZmR.css" />
<style>li:has(ul)>details[open]>summary>a{border-radius:.25rem .25rem 0 0;border-bottom:none}li.depth-1>details[open]>summary>a{background-color:var(--seafoam-10)}li.depth-2>details[open]>summary>a{background-color:var(--seafoam-20)}li.depth-3>details[open]>summary>a{background-color:var(--seafoam-30)}li.depth-4>details[open]>summary>a{background-color:var(--seafoam-40)}li a{display:inline-block;background-color:var(--seafoam-40)}ul[data-astro-cid-b67pdfqh]{list-style:none;display:flex;gap:.125rem;align-items:flex-start;flex-wrap:wrap;padding:.125rem .125rem .125rem .25rem;border:1px solid var(--gray-20)}.note[data-astro-cid-b67pdfqh] header[data-astro-cid-b67pdfqh]{padding-bottom:0}.note[data-astro-cid-b67pdfqh]{border:1px solid var(--gray-50);font-size:.8rem;min-width:min-content}li[data-astro-cid-b67pdfqh].depth-1 ul[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-1);border-color:var(--seafoam-30)}li[data-astro-cid-b67pdfqh].depth-2 ul[data-astro-cid-b67pdfqh]{background-color:var(--violet-1);border-color:var(--violet-30)}li[data-astro-cid-b67pdfqh].depth-3 ul[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-5);border-color:var(--seafoam-40)}li[data-astro-cid-b67pdfqh].depth-4 ul[data-astro-cid-b67pdfqh]{background-color:var(--violet-5);border-color:var(--violet-40)}li[data-astro-cid-b67pdfqh].depth-5 ul[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-10);border-color:var(--seafoam-50)}li[data-astro-cid-b67pdfqh].depth-6 ul[data-astro-cid-b67pdfqh]{background-color:var(--violet-10);border-color:var(--violet-50)}li[data-astro-cid-b67pdfqh]{padding:.2rem .5rem;display:inline-block}a[data-astro-cid-b67pdfqh]{padding:.2rem .5rem;display:inline-block;border:1px solid var(--seafoam-50);border-radius:.25rem}li[data-astro-cid-b67pdfqh],ul[data-astro-cid-b67pdfqh]{border-radius:.25rem}li[data-astro-cid-b67pdfqh]:has(ul)>details[data-astro-cid-b67pdfqh][open]>summary[data-astro-cid-b67pdfqh]>a[data-astro-cid-b67pdfqh]{border-radius:.25rem .25rem 0 0;border-bottom:none}li[data-astro-cid-b67pdfqh].depth-1>details[data-astro-cid-b67pdfqh][open]>summary[data-astro-cid-b67pdfqh]>a[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-10)}li[data-astro-cid-b67pdfqh].depth-2>details[data-astro-cid-b67pdfqh][open]>summary[data-astro-cid-b67pdfqh]>a[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-20)}li[data-astro-cid-b67pdfqh].depth-3>details[data-astro-cid-b67pdfqh][open]>summary[data-astro-cid-b67pdfqh]>a[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-30)}li[data-astro-cid-b67pdfqh].depth-4>details[data-astro-cid-b67pdfqh][open]>summary[data-astro-cid-b67pdfqh]>a[data-astro-cid-b67pdfqh]{background-color:var(--seafoam-40)}li[data-astro-cid-b67pdfqh]:has(ul){flex:1}li[data-astro-cid-b67pdfqh].depth-1 a[data-astro-cid-b67pdfqh]{color:var(--violet-90)}.note p{padding-bottom:0}.note pre{margin:.25rem}ul[data-astro-cid-u4ga7qla]{list-style:none;display:grid;grid-template-columns:1fr 1fr;grid-auto-rows:auto;gap:.125rem;padding:.125rem .125rem .125rem .25rem;border:1px solid var(--gray-20)}.headings[data-astro-cid-u4ga7qla]>[data-astro-cid-u4ga7qla]{width:100%}ul[data-astro-cid-u4ga7qla]{max-width:8.5in;margin:auto}
</style><script type="module" src="/cse130-notes/_astro/hoisted.Ta9NCA9F.js"></script></head> <body>   <h1 data-astro-cid-u4ga7qla>All Notes</h1> <ul class="headings" data-astro-cid-u4ga7qla> <li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 2 - Complexity</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 2 - Complexity</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Issues of Complexity</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Emergent Properties</header><p>When you link stuff together new properties emerge</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Propagation of Effects</header><p>If there’s a bug in one part then that bug can propagate through the system creating more issues</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Incommensurate Scaling</header><p>When something scales differently compared to another part of the system</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Tradeoffs</header></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Complexity Definitions</header><p>Large number of components with a large number of interconnections which are not uniformly organized.</p>
<p>If there are a lot of irregularities and/or it takes many words to describe the system.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Sources of Complexity</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Many Responsibilities</header><p>If the system has to do more then it becomes more complex</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Many Constraints</header><p>If the system has to do the same with fewer resources then it becomes more complex</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Law of Diminishing Returns</header><p>The better the system gets the harder future potential gains get</p>
<p>“Lowest hanging fruit”</p></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Management Strategies</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Modularity</header><p>Break a big problem into smaller pieces.</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Abstraction</header><p>Break into components at logical points and then treat an individual component as a black box which you can trust.</p>
<p>Benefits of Robustness:</p>
<p>Allows for slight differences on the inputs and allows the inputs to be used for more</p>
<p>Ex. JSON api calls usually return a ton of data just in case the developer might need that extra data</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Layering</header><p>Abstractions + Modularity -> many interconnections?</p>
<p>Reduce interconnections with layering</p>
<p>Modules in a layer may only interact with modules in the layer or up/down one layer.</p>
<p>Easier to use and add more functionality but it adds some overhead</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Hierarchy</header><p>Combine small groups of modules into small subsystems</p>
<p>Then combine small subsystems into large systems</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Naming</header><p>Use names to make modules easy to find and easy to replace</p>
<p>Use names to have different sources that get treated the same way</p></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 3 - Memory</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 3 - Memory</header><p>There are three possible functions which a computer might do, store, compute, and communicate.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Store</header><p>Remembers stuff</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Memory</header><p>A place to remember things, modeled as a map between a space of names and a space of values (relies on name abstraction)</p>
<p>Interface:</p>
<p>Write(name, value) - Assign a new value to a name</p>
<p>Value = Read(name) - Get value of name</p></div><ul data-astro-cid-b67pdfqh><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Memory Properties</header></div><ul data-astro-cid-b67pdfqh><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Volatility</header><p>Whether the memory needs power to be applied consistently (span of seconds) in order to remember.</p></div></li><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Abundance</header><p>fewer bits as we move upwards from Tape through HDD, SSD, DRAM, and Caches to Registers</p></div></li><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Cost</header><p>More expensive as we move upwards in terms of $/byte</p></div></li><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Granularity</header><p>the sizes of the values which get requested</p></div></li></ul></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Performance</header></div><ul data-astro-cid-b67pdfqh><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Bandwidth</header><p>memory/time</p></div></li><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Latency</header><p>Time until memory</p></div></li><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Synchronous</header><p>One action at a time</p></div></li><li class="depth-5" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Asynchronous</header><p>Many actions at a time</p></div></li></ul></li></ul></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Compute</header><p>interprets stuff</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Communicate</header><p>Sends stuff</p></div></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 4 - Interpreters/Comm Links</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 4 - Interpreters/Comm Links</header><p>Interpreters execute instructions and occasionally sends out messages using communication links.</p>
<p>Communication links allow for sending and receiving messages.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Interpreters - Compute</header><p>Interpreters execute instructions and occasionally sends out messages using communication links.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Instruction Reference</header><p>reference to next instruction</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Repotoire</header><p>what commands are available</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Environment Reference</header><p>where to output stuff</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>List of Examples</header></div><ul data-astro-cid-b67pdfqh><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>General Purpose</header><ul>
<li>Laptop</li>
<li>Infotainment system in car</li>
</ul></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Special Purpose</header><ul>
<li>Keyboard</li>
<li>Mouse</li>
<li>Laser Printer</li>
<li>Software-defined radio</li>
<li>Microwave oven</li>
<li>Clock chip</li>
<li>USB interface</li>
</ul></div></li></ul></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Layers of Interpretation</header><p>Interpreters can be built on top of interpreters. (turtles all the way down)</p>
<p>This creates layers of interpreters.</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Interpreter Layer Design Goals</header><ul>
<li>Do either what was asked or do nothing</li>
<li>Half-completed tasks are not allowed</li>
</ul></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Comm Links - Communicate</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>List of Examples</header></div><ul data-astro-cid-b67pdfqh><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Hardware</header><ul>
<li>Twisted pair</li>
<li>Coaxial cable</li>
<li>Optical fiber</li>
</ul></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Higher Level</header><ul>
<li>Ethernet</li>
<li>USB</li>
<li>The internet</li>
<li>The telephone system</li>
<li>A Unix pipexw</li>
</ul></div></li></ul></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Operations</header><ul>
<li>SEND(link_name, outgoing_message_buffer)</li>
<li>RECEIVE(link_name, incoming_message_buffer)</li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Link Names</header><p>link_name depends on layer:</p>
<ul>
<li>TCP port number</li>
<li>IP address</li>
<li>Internet address</li>
<li>Many parts: roger@<ip>:<port></port></ip></li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Message Buffers</header><p>Abstractions with buffer length</p></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 5 - File I/O</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 5 - File I/O</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Buffered vs Unbuffered I/O</header><p>fread is buffered while read is unbuffered.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>read</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#include</span><span style="color:#846905"> &#x3C;unistd.h></span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">int</span><span style="color:#313233"> res </span><span style="color:#CE9409">=</span><span style="color:#345348"> read</span><span style="color:#313233">(</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#2D27A4"> fd</span><span style="color:#313233">,</span></span>
<span class="line"><span style="color:#CE9409">    void</span><span style="color:#CE9409"> *</span><span style="color:#2D27A4">buf</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // buffer to read into</span></span>
<span class="line"><span style="color:#CE9409">    size_t</span><span style="color:#2D27A4"> count</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // max number of bytes to read</span></span>
<span class="line"><span style="color:#313233">);</span></span></code></pre>
<p>returns number of bytes read, 0 for EOF, -1 for error</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>write</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#include</span><span style="color:#846905"> &#x3C;unistd.h></span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">int</span><span style="color:#313233"> res </span><span style="color:#CE9409">=</span><span style="color:#345348"> write</span><span style="color:#313233">(</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#2D27A4"> fd</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // file descriptor - gotten from open() call</span></span>
<span class="line"><span style="color:#CE9409">    const</span><span style="color:#CE9409"> void</span><span style="color:#CE9409"> *</span><span style="color:#2D27A4">buf</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // buffer to write from</span></span>
<span class="line"><span style="color:#CE9409">    size_t</span><span style="color:#2D27A4"> count</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // number of bytes to write</span></span>
<span class="line"><span style="color:#313233">);</span></span>
<span class="line"><span style="color:#6E9D87">// returns number of bytes written, -1 for error</span></span></code></pre></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>open</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#include</span><span style="color:#846905"> &#x3C;fcntl.h></span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">int</span><span style="color:#313233"> fd </span><span style="color:#CE9409">=</span><span style="color:#345348"> open</span><span style="color:#313233">(</span></span>
<span class="line"><span style="color:#CE9409">    const</span><span style="color:#CE9409"> char</span><span style="color:#CE9409"> *</span><span style="color:#2D27A4">pathname</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // path to file</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#2D27A4"> flags</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // flags - see below</span></span>
<span class="line"><span style="color:#CE9409">    mode_t</span><span style="color:#2D27A4"> mode</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // file perms if O_CREAT</span></span>
<span class="line"><span style="color:#313233">);</span></span></code></pre></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Flags</header><ul>
<li><code>O_RDONLY</code> - read only</li>
<li><code>O_WRONLY</code> - write only</li>
<li><code>O_WRONLY | O_CREAT</code> - create file if it doesn’t exist</li>
<li><code>O_WRONLY | O_TRUNC</code> - truncate file if it exists (delete initial contents of file)</li>
<li><code>O_WRONLY | O_CREAT | O_TRUNC</code> - create file if it doesn’t exist, truncate if it does - equivalent to <code>creat()</code> call</li>
</ul></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>close</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#include</span><span style="color:#846905"> &#x3C;unistd.h></span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">int</span><span style="color:#313233"> res </span><span style="color:#CE9409">=</span><span style="color:#345348"> close</span><span style="color:#313233">(</span><span style="color:#CE9409">int</span><span style="color:#2D27A4"> fd</span><span style="color:#313233">);</span></span>
<span class="line"><span style="color:#6E9D87">// returns 0 for success, -1 for error</span></span></code></pre></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>unlink</header><p>Deletes the file at path <code>name</code>.</p>
<pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#include</span><span style="color:#846905"> &#x3C;unistd.h></span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">int</span><span style="color:#313233"> res </span><span style="color:#CE9409">=</span><span style="color:#345348"> unlink</span><span style="color:#313233">(</span><span style="color:#CE9409">const</span><span style="color:#CE9409"> char</span><span style="color:#CE9409"> *</span><span style="color:#2D27A4">name</span><span style="color:#313233">);</span></span>
<span class="line"><span style="color:#6E9D87">// returns 0 for success, -1 for error</span></span></code></pre></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>lseek</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#include</span><span style="color:#846905"> &#x3C;unistd.h></span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">off_t</span><span style="color:#313233"> res </span><span style="color:#CE9409">=</span><span style="color:#345348"> lseek</span><span style="color:#313233">(</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#2D27A4"> fd</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // file descriptor</span></span>
<span class="line"><span style="color:#CE9409">    off_t</span><span style="color:#2D27A4"> offset</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // number of bytes to move</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#2D27A4"> origin</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // SEEK_SET, SEEK_CUR, SEEK_END</span></span>
<span class="line"><span style="color:#313233">);</span></span>
<span class="line"><span style="color:#6E9D87">// returns new offset from beginning of file, -1 for error</span></span></code></pre></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>offset</header><ul>
<li>SEEK_SET - from beginning of file</li>
<li>SEEK_CUR - from current position</li>
<li>SEEK_END - from end of file</li>
</ul></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 6 - Regex</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 6 - Regex</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>regcomp</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#313233">regex_t preg;</span></span>
<span class="line"><span style="color:#CE9409">int</span><span style="color:#345348"> regcomp</span><span style="color:#313233">(regex_t </span><span style="color:#CE9409">*</span><span style="color:#2D27A4">preg</span><span style="color:#313233">, </span><span style="color:#CE9409">const</span><span style="color:#CE9409"> char</span><span style="color:#CE9409"> *</span><span style="color:#2D27A4">regex</span><span style="color:#313233">, </span><span style="color:#CE9409">int</span><span style="color:#2D27A4"> cflags</span><span style="color:#313233">);</span></span></code></pre>
<ul>
<li>preg - declared regex_t structure which is a reference to the compiled regular expression.</li>
<li>regex - the regular expression to be compiled (c string).</li>
<li>cflags - flags that control the compilation of the regular expression.
<ul>
<li>REG_EXTENDED - Use extended regular expressions - treats +, ?, parentheses, etc. as special characters without being escaped.</li>
<li>REG_NEWLINE - multiline REGEX.</li>
<li>Can be combined with |.</li>
</ul>
</li>
</ul></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>regfree</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">void</span><span style="color:#345348"> regfree</span><span style="color:#313233">(regex_t </span><span style="color:#CE9409">*</span><span style="color:#2D27A4">preg</span><span style="color:#313233">);</span></span></code></pre></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>regexec</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">int</span><span style="color:#345348"> regexec</span><span style="color:#313233">(</span></span>
<span class="line"><span style="color:#CE9409">    const</span><span style="color:#313233"> regex_t </span><span style="color:#CE9409">*</span><span style="color:#2D27A4">preg</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // compiled regular expression</span></span>
<span class="line"><span style="color:#CE9409">    const</span><span style="color:#CE9409"> char</span><span style="color:#CE9409"> *</span><span style="color:#2D27A4">string</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // string to match</span></span>
<span class="line"><span style="color:#CE9409">    size_t</span><span style="color:#2D27A4"> nmatch</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // number of elements in pmatch</span></span>
<span class="line"><span style="color:#313233">    regmatch_t </span><span style="color:#2D27A4">pmatch</span><span style="color:#CE9409">[]</span><span style="color:#313233">,</span><span style="color:#6E9D87"> // see below</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#313233"> eflags</span><span style="color:#6E9D87"> // flags</span></span>
<span class="line"><span style="color:#313233">    );</span></span></code></pre></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>pmatch/nmatch</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#846905">typedef</span><span style="color:#CE9409"> struct</span><span style="color:#313233"> {</span></span>
<span class="line"><span style="color:#313233">    regoff_t rm_so;</span><span style="color:#6E9D87"> // start of match</span></span>
<span class="line"><span style="color:#313233">    regoff_t rm_eo;</span><span style="color:#6E9D87"> // end of match</span></span>
<span class="line"><span style="color:#313233">} regmatch_t;</span></span></code></pre>
<p>If <code>regex == "([a-z]+) ([0-9]+)"</code> then <code>nmatch</code> should be 3.</p>
<p>if <code>string == "hello 123"</code>, then:</p>
<ul>
<li><code>pmatch[0]</code> is the entire match: <code>hello 123</code></li>
<li><code>match[1]</code> is <code>hello</code></li>
<li><code>pmatch[2]</code> is <code>123</code></li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Return value</header><p>0 for success, error code for failure. Can call <code>regerror()</code> to convert the error code to a string.</p></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 8 - Client-Server Model</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 8 - Client-Server Model</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Adv. of Client-Server</header><p>Strengthen modularity:</p>
<ul>
<li>Limit interaction between modules (no propagation of effects via global variables)</li>
<li>Prevent propagation of errors</li>
<li>Provide flexibility and interchangability</li>
</ul>
<p>Uses only message passing to communicate between modules.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Soft vs Hard Modularity</header><p>Soft modularity is when an error can propagate between modules, while hard
modularity is when an error cannot.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Protection Against Errors</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Soft Modularity</header><p>Some programming languages can prevent too much error propagation but it is still difficult.</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Hard Modularity</header><ul>
<li>Client can time out and then try elsewhere</li>
</ul>
<p>Limited interaction means limited errors</p></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Possible Issues with Messages</header><p>What if the message is lost?</p>
<ul>
<li>Do they all fail?</li>
<li>Do only some fail?</li>
<li>Are they out of order?</li>
</ul>
<p>If all messages are required then acknowledgement is usually needed.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>If (client/server) fails</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Client</header><ul>
<li>Server usually unaffected</li>
<li>if client fails midway through a request then the server can timeout</li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Server</header><ul>
<li>Client checks messages for correctness and validity</li>
<li>Client times out and tries a different server</li>
<li>Server is usually restartable without affecting clients</li>
</ul></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Possible Client-Server Issues</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Representation</header><p>SerDe is hard! Little Endian vs Big Endian, etc.</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Message Ordering</header><p>Some networks can reorder messages</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Malicious/Buggy Servers &amp; Clients</header></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Scaling</header><p>Multiple servers + multiple clients</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Multiple Clients</header><ul>
<li>Server might want to keep clients separate</li>
<li>Server might want to facilitate sharing</li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Multiple Servers</header><ul>
<li>Client may request different services</li>
<li>Client might pick best server for its needs</li>
<li>Client might need to stick to one server</li>
</ul></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 9 - RPCs</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 9 - RPCs</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Stubs</header><p>Handles sending and receiving the command and arguments for both the client and the server.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Client</header><p>Serializes command + args and later receives the response from the server and passes it to the initiating process.</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Server</header><p>Deserializes command + args and calls the requested method.</p></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Marshaling/Serialization</header><p>Ensuring that the client and server data types are compatible.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Hiccups in Marshaling</header><ul>
<li>Little-endian vs big-endian</li>
<li>size of integers</li>
<li>floating point format (IEEE/Intel?)</li>
<li>Pointers (unswizzle/swizzle)</li>
</ul></div><ul data-astro-cid-b67pdfqh><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Swizzling</header><p>Unswizzling is to give each object a unique identifier and then use that identifier in place of any pointers.</p>
<p>To swizzle is to replace the unique identifier with a pointer to the object.</p></div></li></ul></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Error Handling</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>At least once</header><p>Retry until client gets a positive acknowledgement.</p>
<p>Request should be idempotent. (aka no side effect from repeated requests)</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>At most once</header><p>Send one request and wait for a response. If there’s no response then it’s considered failed but the client shouldn’t retry.</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Exactly once</header><ul>
<li>Retry until acknowledgement</li>
<li>Client and server track requests</li>
<li>Much more complex
<ul>
<li>More corner cases</li>
<li>But more reliable</li>
</ul>
</li>
</ul></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Dealing w/ Inefficiency</header><p>Less efficient because:</p>
<ul>
<li>Marshaling takes time</li>
<li>Network takes time</li>
<li>Only pass by value allowed</li>
</ul></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Async RPCs</header><ul>
<li>Client sends request and waits for an accept from the server</li>
<li>Then client can do other things while waiting for the response</li>
<li>After the client gets a response it sends and acknowledgement to the server to end the RPC</li>
</ul></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Intermediaries</header><p>If either is offline then buffers can be used instead.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Notification</header><ul>
<li>Push (initiator sends message) / Pull (initiator requests message)</li>
<li>Decoupled: intermediary makes decisions on when to deliver message</li>
</ul>
<p>Example:</p>
<ul>
<li>Publish/Subscribe: recipients subscribe to service, and are notified when a service “publishes” a new message</li>
</ul></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 11 - HTTP Server</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 11 - HTTP Server</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Your HTTP Server</header></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Sockets/Helper Functions</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Normal Socket Procedure</header></div><ul data-astro-cid-b67pdfqh><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>listener_socket = socket(...)</header><p>Creates a listener socket</p></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>bind(listener_socket, ...)</header><p>Binds the listener socket to a port</p></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>listen(listener_socket, ...)</header><p>Starts listening for incoming connections</p></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>accept(listener_socket, ...)</header><p><code>connection_fd = accept(listener_socket, ...)</code></p>
<p>Accepts a new connection, returning a file descriptor to that connection</p></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>setsockopt(connection_fd, …)</header><p>Sets options for the connection, including timeouts (will return a EAGAIN error if the connection times out)</p></div></li><li class="depth-4" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Typical Ordering</header><ol>
<li>Make a socket</li>
<li>bind to a port</li>
<li>listen</li>
<li>accept</li>
<li>setsockopt</li>
<li>read/write</li>
<li>close</li>
</ol>
<p>See Day 5 to review read/write/close calls &#x26; file descriptors.</p></div></li></ul></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 12 - Virtualization</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 12 - Virtualization</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Virtualization</header><p>Client/server good because it forces organization and improves security. (less area of attack)</p>
<p>Client/server bad because you need many machines to run the server. Maybe virtualization can help? Docker time baby!</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Multiplexing</header><p>Is soft modularity</p>
<p>Three basic techniques:</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Aggregation</header><p>One masquerading as many.
<img src="./images/day12/multiplexing.png" alt="One source advertising as many"></p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh></header><p>Multiple masquerading as one.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Emulation</header></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Virtual Memory</header><p>Pretend to be something else.</p>
<p><img src="./images/day12/emulation.png" alt="many different sources pretending to be something else"></p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Comm Link: Bounded Buffers</header><p>Gives each process an entire address space, but then behind the scenes coordinates with the OS (and hardware) to share the physical memory.</p>
<p>This lets multiple applications run at the same time without interfering with each other. (unless the entire computer runs out of memory)</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>How to Synchronize Bounded Buffers</header><p>An OS provides bounded buffers which allow threads to communicate via send/receive.</p></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 13 - Virtualization Cont.</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 13 - Virtualization Cont.</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Comparison: Cyclic Executive vs Separate Threads</header></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Cyclic Executive</header><ul>
<li>Each task is given a fixed amount of time to run for each cycle</li>
<li>A task yields back to the scheduler after its time is up</li>
<li>The next task can only run after the current task yields</li>
<li>Tasks are run in a fixed order</li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Separate Threads</header><ul>
<li>all tasks run at the same time but are scheduled by the OS and can be interrupted /woven after any arbitrary assembly instruction, meaning that each task is no longer atomic</li>
</ul></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Bounded Buffer</header><p>Problem: counter = counter + 1 isn’t atomic</p>
<p>To make it atomic use mutexes to make sure a push’s increment can’t happen at the same time as a pop’s decrement.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Race conditions</header></div></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 14 - Virtualization Cont.</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 14 - Virtualization Cont.</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Race conditions</header><p>A race condition is when the behavior of a system depends on the timing of events.</p></div></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Mutual Exclusion (Mutex)</header><p>Ensures that only one thread is inside a critical section at a time (where the code reads and manipulates a shared variable).</p>
<p>Shared variables can even include variables which are shared between parallel calls to the same function.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>How to Use</header><p>Call acquire before entering a critical section and call release after leaving the critical section. If there is a spinlock inside the critical section then make sure to regularly release and reacquire the lock during the spinlock.</p></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Locks &amp; Condition Variables</header><p>Each condition variable has exactly one lock.</p>
<p>Three functions:</p>
<ul>
<li><code>wait()</code> - release lock, wait for a signal/broadcast, reacquire lock</li>
<li><code>signal()</code> wake any one of the threads that are waiting on the condition variable</li>
<li><code>broadcast()</code> - wake all threads that are waiting on a condition variable</li>
</ul></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>How to Use</header><p>Use to avoid busy waiting. An example is to have a condition variable for when a buffer is full and another for when a buffer is empty.</p></div></li></ul></li><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Semaphores</header><p>Problem: previous solutions waste CPU times</p>
<p>Uses two atomic operations:</p>
<ul>
<li><code>up(S) &#x3C;- S + 1</code></li>
<li><code>down(S): while (S &#x3C;= 0) {}; S &#x3C;- S - 1</code>
<ul>
<li>Down can be modified to eliminate busy waiting for S to be greater than 0</li>
</ul>
</li>
</ul>
<p>Note: up is sometimes <code>V()</code> and down is sometimes <code>P()</code>.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Two Types</header><p>Binary: 0 or 1
Counting: 0 to ∞</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>General Synchronization</header><ul>
<li>Mutex</li>
<li>Rendezvous semaphore (one thread waits for another before proceeding)</li>
<li>Like rendezvous but n threads wait for the last one before proceeding</li>
</ul></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>How to Use</header><p>Use to avoid busy waiting. An example is to have a semaphore for when a buffer is full (initialized to N) and another for when a buffer is empty (initialized to 0). Lastly use a binary semaphore to protect the buffer (inc/dec).</p></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Binary Semaphore vs Mutex</header><p>A binary semaphore can be used to implement a mutex but a mutex cannot be used to implement a binary semaphore. A mutex must be released by the same thread that acquired it while a binary semaphore can be released by any thread.</p></div></li></ul></li></ul></li></ul></li><li class="depth-0" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 15 - Virtualization Cont.</header></div><ul data-astro-cid-b67pdfqh><li class="depth-1" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Day 15 - Virtualization Cont.</header></div><ul data-astro-cid-b67pdfqh><li class="depth-2" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Bounded Buffer Example</header><pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#CE9409">#define</span><span style="color:#345348"> N</span><span style="color:#313233"> ...</span><span style="color:#6E9D87"> // buffer size</span></span>
<span class="line"></span>
<span class="line"><span style="color:#313233">Globals:</span></span>
<span class="line"><span style="color:#313233">    Item </span><span style="color:#2D27A4">buffer</span><span style="color:#313233">[N];</span></span>
<span class="line"><span style="color:#CE9409">    int</span><span style="color:#313233"> in </span><span style="color:#CE9409">=</span><span style="color:#413900"> 0</span><span style="color:#313233">, out </span><span style="color:#CE9409">=</span><span style="color:#413900"> 0</span><span style="color:#313233">, counter </span><span style="color:#CE9409">=</span><span style="color:#413900"> 0</span><span style="color:#313233">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">void</span><span style="color:#345348"> push</span><span style="color:#313233">(Item </span><span style="color:#2D27A4">item</span><span style="color:#313233">) {</span></span>
<span class="line"><span style="color:#CE9409">    while</span><span style="color:#313233"> (counter </span><span style="color:#CE9409">==</span><span style="color:#313233"> N) {}</span><span style="color:#6E9D87"> // busy waiting</span></span>
<span class="line"><span style="color:#2D27A4">    buffer</span><span style="color:#313233">[in] </span><span style="color:#CE9409">=</span><span style="color:#313233"> item;</span></span>
<span class="line"><span style="color:#313233">    in </span><span style="color:#CE9409">=</span><span style="color:#313233"> (in </span><span style="color:#CE9409">+</span><span style="color:#413900"> 1</span><span style="color:#313233">) </span><span style="color:#CE9409">%</span><span style="color:#313233"> N;</span></span>
<span class="line"><span style="color:#313233">    counter</span><span style="color:#CE9409">++</span><span style="color:#313233">;</span></span>
<span class="line"><span style="color:#313233">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#313233">Item </span><span style="color:#345348">pop</span><span style="color:#313233">() {</span></span>
<span class="line"><span style="color:#CE9409">    while</span><span style="color:#313233"> (counter </span><span style="color:#CE9409">==</span><span style="color:#413900"> 0</span><span style="color:#313233">) {}</span><span style="color:#6E9D87"> // busy waiting</span></span>
<span class="line"><span style="color:#313233">    Item item </span><span style="color:#CE9409">=</span><span style="color:#2D27A4"> buffer</span><span style="color:#313233">[out];</span></span>
<span class="line"><span style="color:#313233">    out </span><span style="color:#CE9409">=</span><span style="color:#313233"> (out </span><span style="color:#CE9409">+</span><span style="color:#413900"> 1</span><span style="color:#313233">) </span><span style="color:#CE9409">%</span><span style="color:#313233"> N;</span></span>
<span class="line"><span style="color:#313233">    counter</span><span style="color:#CE9409">--</span><span style="color:#313233">;</span></span>
<span class="line"><span style="color:#CE9409">    return</span><span style="color:#313233"> item;</span></span>
<span class="line"><span style="color:#313233">}</span></span>
<span class="line"></span></code></pre>
<p>The above code has a race condition.</p></div><ul data-astro-cid-b67pdfqh><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Mutex</header><p>One possible fix is with a mutex:</p>
<pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#313233">Globals:</span></span>
<span class="line"><span style="color:#313233">    Lock l;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">void</span><span style="color:#345348"> push</span><span style="color:#313233">(Item </span><span style="color:#2D27A4">item</span><span style="color:#313233">) {</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">acquire</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#CE9409">    while</span><span style="color:#313233"> (counter </span><span style="color:#CE9409">==</span><span style="color:#313233"> N) {</span></span>
<span class="line"><span style="color:#2D27A4">        l</span><span style="color:#313233">.</span><span style="color:#345348">release</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#2D27A4">        l</span><span style="color:#313233">.</span><span style="color:#345348">acquire</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#313233">    }</span><span style="color:#6E9D87"> // busy waiting</span></span>
<span class="line"><span style="color:#2D27A4">    Buffer</span><span style="color:#313233">[in] </span><span style="color:#CE9409">=</span><span style="color:#313233"> item;</span></span>
<span class="line"><span style="color:#313233">    in </span><span style="color:#CE9409">=</span><span style="color:#313233"> (in </span><span style="color:#CE9409">+</span><span style="color:#413900"> 1</span><span style="color:#313233">) </span><span style="color:#CE9409">%</span><span style="color:#313233"> N;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#313233">    counter</span><span style="color:#CE9409">++</span><span style="color:#313233">;</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">release</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#313233">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">void</span><span style="color:#345348"> pop</span><span style="color:#313233">() {</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">acquire</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#CE9409">    while</span><span style="color:#313233"> (counter </span><span style="color:#CE9409">==</span><span style="color:#413900"> 0</span><span style="color:#313233">) {</span></span>
<span class="line"><span style="color:#2D27A4">        l</span><span style="color:#313233">.</span><span style="color:#345348">release</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#2D27A4">        l</span><span style="color:#313233">.</span><span style="color:#345348">acquire</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#313233">    }</span><span style="color:#6E9D87"> // busy waiting</span></span>
<span class="line"><span style="color:#313233">    Item item </span><span style="color:#CE9409">=</span><span style="color:#2D27A4"> buffer</span><span style="color:#313233">[out];</span></span>
<span class="line"><span style="color:#313233">    out </span><span style="color:#CE9409">=</span><span style="color:#313233"> (out </span><span style="color:#CE9409">+</span><span style="color:#413900"> 1</span><span style="color:#313233">) </span><span style="color:#CE9409">%</span><span style="color:#313233"> N;</span></span>
<span class="line"><span style="color:#313233">    counter</span><span style="color:#CE9409">--</span><span style="color:#313233">;</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">release</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#CE9409">    return</span><span style="color:#313233"> item;</span></span>
<span class="line"><span style="color:#313233">}</span></span>
<span class="line"></span></code></pre></div></li><li class="depth-3" data-astro-cid-b67pdfqh><div class="note" data-astro-cid-b67pdfqh><header data-astro-cid-b67pdfqh>Condition Variable</header><p>However, the mutex solution creates needless spin locks. A better solution is to use condition variables:</p>
<pre class="astro-code by https://github.com/el-angel/theme-editor" style="background-color:#E5E6E2;color:#19191A; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#313233">Globals:</span></span>
<span class="line"><span style="color:#313233">    Lock l;</span></span>
<span class="line"><span style="color:#313233">    Condition full, empty;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">void</span><span style="color:#345348"> push</span><span style="color:#313233">(Item </span><span style="color:#2D27A4">item</span><span style="color:#313233">) {</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">acquire</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#CE9409">    while</span><span style="color:#313233"> (counter </span><span style="color:#CE9409">==</span><span style="color:#313233"> N) {</span></span>
<span class="line"><span style="color:#2D27A4">        full</span><span style="color:#313233">.</span><span style="color:#345348">wait</span><span style="color:#313233">(l);</span></span>
<span class="line"><span style="color:#313233">    }</span><span style="color:#6E9D87"> // busy waiting</span></span>
<span class="line"><span style="color:#2D27A4">    Buffer</span><span style="color:#313233">[in] </span><span style="color:#CE9409">=</span><span style="color:#313233"> item;</span></span>
<span class="line"><span style="color:#313233">    in </span><span style="color:#CE9409">=</span><span style="color:#313233"> (in </span><span style="color:#CE9409">+</span><span style="color:#413900"> 1</span><span style="color:#313233">) </span><span style="color:#CE9409">%</span><span style="color:#313233"> N;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#313233">    counter</span><span style="color:#CE9409">++</span><span style="color:#313233">;</span></span>
<span class="line"><span style="color:#2D27A4">    empty</span><span style="color:#313233">.</span><span style="color:#345348">signal</span><span style="color:#313233">(l);</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">release</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#313233">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CE9409">void</span><span style="color:#345348"> pop</span><span style="color:#313233">() {</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">acquire</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#CE9409">    while</span><span style="color:#313233"> (counter </span><span style="color:#CE9409">==</span><span style="color:#413900"> 0</span><span style="color:#313233">) {</span></span>
<span class="line"><span style="color:#2D27A4">        empty</span><span style="color:#313233">.</span><span style="color:#345348">wait</span><span style="color:#313233">(l);</span></span>
<span class="line"><span style="color:#313233">    }</span><span style="color:#6E9D87"> // busy waiting</span></span>
<span class="line"><span style="color:#313233">    Item item </span><span style="color:#CE9409">=</span><span style="color:#2D27A4"> buffer</span><span style="color:#313233">[out];</span></span>
<span class="line"><span style="color:#313233">    out </span><span style="color:#CE9409">=</span><span style="color:#313233"> (out </span><span style="color:#CE9409">+</span><span style="color:#413900"> 1</span><span style="color:#313233">) </span><span style="color:#CE9409">%</span><span style="color:#313233"> N;</span></span>
<span class="line"><span style="color:#313233">    counter</span><span style="color:#CE9409">--</span><span style="color:#313233">;</span></span>
<span class="line"><span style="color:#2D27A4">    full</span><span style="color:#313233">.</span><span style="color:#345348">signal</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#2D27A4">    l</span><span style="color:#313233">.</span><span style="color:#345348">release</span><span style="color:#313233">();</span></span>
<span class="line"><span style="color:#CE9409">    return</span><span style="color:#313233"> item;</span></span>
<span class="line"><span style="color:#313233">}</span></span></code></pre></div></li></ul></li></ul></li></ul></li> </ul>   </body> </html> 